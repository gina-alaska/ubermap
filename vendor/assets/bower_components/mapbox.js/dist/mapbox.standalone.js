!function t(e,n,o){function i(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,e){"use strict";window.L.Icon.Default.imagePath="//api.tiles.mapbox.com/mapbox.js/v"+t("./package.json").version+"/images";var n=t("./src/geocoder_control"),o=t("./src/grid_control"),i=t("./src/feature_layer"),r=t("./src/legend_control"),a=t("./src/share_control"),s=t("./src/tile_layer"),l=t("./src/info_control"),c=t("./src/map"),u=t("./src/grid_layer");L.mapbox=e.exports={VERSION:t("./package.json").version,geocoder:t("./src/geocoder"),marker:t("./src/marker"),simplestyle:t("./src/simplestyle"),tileLayer:s.tileLayer,TileLayer:s.TileLayer,infoControl:l.infoControl,InfoControl:l.InfoControl,shareControl:a.shareControl,ShareControl:a.ShareControl,legendControl:r.legendControl,LegendControl:r.LegendControl,geocoderControl:n.geocoderControl,GeocoderControl:n.GeocoderControl,gridControl:o.gridControl,GridControl:o.GridControl,gridLayer:u.gridLayer,GridLayer:u.GridLayer,featureLayer:i.featureLayer,FeatureLayer:i.FeatureLayer,map:c.map,Map:c.Map,config:t("./src/config"),sanitize:t("sanitize-caja"),template:t("mustache").to_html},L.mapbox.markerLayer=L.mapbox.featureLayer},{"./package.json":7,"./src/config":8,"./src/feature_layer":9,"./src/geocoder":10,"./src/geocoder_control":11,"./src/grid_control":13,"./src/grid_layer":14,"./src/info_control":15,"./src/legend_control":16,"./src/map":18,"./src/marker":19,"./src/share_control":21,"./src/simplestyle":22,"./src/tile_layer":23,mustache:4,"sanitize-caja":5}],2:[function(t,e){function n(t,e,n){function o(t){return t>=200&&300>t||304===t}function i(){void 0===s.status||o(s.status)?e.call(s,null,s):e.call(s,s,null)}var r=!1;if("undefined"==typeof window.XMLHttpRequest)return e(Error("Browser not supported"));if("undefined"==typeof n){var a=t.match(/^\s*https?:\/\/[^\/]*/);n=a&&a[0]!==location.protocol+"//"+location.domain+(location.port?":"+location.port:"")}var s;if(!n||"object"!=typeof window.XDomainRequest&&"function"!=typeof window.XDomainRequest)s=new window.XMLHttpRequest;else{s=new window.XDomainRequest;var l=e;e=function(){if(r)l.apply(this,arguments);else{var t=this,e=arguments;setTimeout(function(){l.apply(t,e)},0)}}}return"onload"in s?s.onload=i:s.onreadystatechange=function(){4===s.readyState&&i()},s.onerror=function(t){e.call(this,t||!0,null),e=function(){}},s.onprogress=function(){},s.ontimeout=function(t){e.call(this,t,null),e=function(){}},s.onabort=function(t){e.call(this,t,null),e=function(){}},s.open("GET",t,!0),s.send(null),r=!0,s}"undefined"!=typeof e&&(e.exports=n)},{}],3:[function(t,e,n){var o="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){function t(e,n){function o(t){if(o[t]!==g)return o[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=o("json-stringify")&&o("json-parse");else{var r,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var l=n.stringify,u="function"==typeof l&&y;if(u){(r=function(){return 1}).toJSON=r;try{u="0"===l(0)&&"0"===l(new i)&&'""'==l(new a)&&l(L)===g&&l(g)===g&&l()===g&&"1"===l(r)&&"[1]"==l([r])&&"[null]"==l([g])&&"null"==l(null)&&"[null,null,null]"==l([g,L,null])&&l({a:[r,!0,!1,null,"\x00\b\n\f\r	"]})==s&&"1"===l(null,r)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(h){u=!1}}e=u}if("json-parse"==t){var p=n.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){r=p(s);var f=5==r.a.length&&1===r.a[0];if(f){try{f=!p('"	"')}catch(h){}if(f)try{f=1!==p("01")}catch(h){}if(f)try{f=1!==p("1.")}catch(h){}}}}catch(h){f=!1}e=f}}return o[t]=!!e}e||(e=s.Object()),n||(n=s.Object());var i=e.Number||s.Number,a=e.String||s.String,l=e.Object||s.Object,c=e.Date||s.Date,u=e.SyntaxError||s.SyntaxError,h=e.TypeError||s.TypeError,p=e.Math||s.Math,f=e.JSON||s.JSON;"object"==typeof f&&f&&(n.stringify=f.stringify,n.parse=f.parse);var d,m,g,_=l.prototype,L=_.toString,y=new c(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(v){}if(!o("json")){var b="[object Function]",T="[object Date]",E="[object Number]",C="[object String]",w="[object Array]",M="[object Boolean]",x=o("bug-string-char-index");if(!y)var S=p.floor,k=[0,31,59,90,120,151,181,212,243,273,304,334],D=function(t,e){return k[e]+365*(t-1970)+S((t-1969+(e=+(e>1)))/4)-S((t-1901+e)/100)+S((t-1601+e)/400)};if((d=_.hasOwnProperty)||(d=function(t){var e,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=L?d=function(t){var e=this.__proto__,n=t in(this.__proto__=null,this);return this.__proto__=e,n}:(e=n.constructor,d=function(t){var n=(this.constructor||e).prototype;return t in this&&!(t in n&&this[t]===n[t])}),n=null,d.call(this,t)}),m=function(t,e){var n,o,i,a=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,o=new n;for(i in o)d.call(o,i)&&a++;return n=o=null,a?m=2==a?function(t,e){var n,o={},i=L.call(t)==b;for(n in t)i&&"prototype"==n||d.call(o,n)||!(o[n]=1)||!d.call(t,n)||e(n)}:function(t,e){var n,o,i=L.call(t)==b;for(n in t)i&&"prototype"==n||!d.call(t,n)||(o="constructor"===n)||e(n);(o||d.call(t,n="constructor"))&&e(n)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],m=function(t,e){var n,i,a=L.call(t)==b,s=!a&&"function"!=typeof t.constructor&&r[typeof t.hasOwnProperty]&&t.hasOwnProperty||d;for(n in t)a&&"prototype"==n||!s.call(t,n)||e(n);for(i=o.length;n=o[--i];s.call(t,n)&&e(n));}),m(t,e)},!o("json-stringify")){var H={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",R=function(t,e){return(A+(e||0)).slice(-t)},U="\\u00",O=function(t){for(var e='"',n=0,o=t.length,i=!x||o>10,r=i&&(x?t.split(""):t);o>n;n++){var a=t.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=H[a];break;default:if(32>a){e+=U+R(2,a.toString(16));break}e+=i?r[n]:t.charAt(n)}}return e+'"'},j=function(t,e,n,o,i,r,a){var s,l,c,u,p,f,_,y,v,b,x,k,H,A,U,P;try{s=e[t]}catch(N){}if("object"==typeof s&&s)if(l=L.call(s),l!=T||d.call(s,"toJSON"))"function"==typeof s.toJSON&&(l!=E&&l!=C&&l!=w||d.call(s,"toJSON"))&&(s=s.toJSON(t));else if(s>-1/0&&1/0>s){if(D){for(p=S(s/864e5),c=S(p/365.2425)+1970-1;D(c+1,0)<=p;c++);for(u=S((p-D(c,0))/30.42);D(c,u+1)<=p;u++);p=1+p-D(c,u),f=(s%864e5+864e5)%864e5,_=S(f/36e5)%24,y=S(f/6e4)%60,v=S(f/1e3)%60,b=f%1e3}else c=s.getUTCFullYear(),u=s.getUTCMonth(),p=s.getUTCDate(),_=s.getUTCHours(),y=s.getUTCMinutes(),v=s.getUTCSeconds(),b=s.getUTCMilliseconds();s=(0>=c||c>=1e4?(0>c?"-":"+")+R(6,0>c?-c:c):R(4,c))+"-"+R(2,u+1)+"-"+R(2,p)+"T"+R(2,_)+":"+R(2,y)+":"+R(2,v)+"."+R(3,b)+"Z"}else s=null;if(n&&(s=n.call(e,t,s)),null===s)return"null";if(l=L.call(s),l==M)return""+s;if(l==E)return s>-1/0&&1/0>s?""+s:"null";if(l==C)return O(""+s);if("object"==typeof s){for(A=a.length;A--;)if(a[A]===s)throw h();if(a.push(s),x=[],U=r,r+=i,l==w){for(H=0,A=s.length;A>H;H++)k=j(H,s,n,o,i,r,a),x.push(k===g?"null":k);P=x.length?i?"[\n"+r+x.join(",\n"+r)+"\n"+U+"]":"["+x.join(",")+"]":"[]"}else m(o||s,function(t){var e=j(t,s,n,o,i,r,a);e!==g&&x.push(O(t)+":"+(i?" ":"")+e)}),P=x.length?i?"{\n"+r+x.join(",\n"+r)+"\n"+U+"}":"{"+x.join(",")+"}":"{}";return a.pop(),P}};n.stringify=function(t,e,n){var o,i,a,s;if(r[typeof e]&&e)if((s=L.call(e))==b)i=e;else if(s==w){a={};for(var l,c=0,u=e.length;u>c;l=e[c++],s=L.call(l),(s==C||s==E)&&(a[l]=1));}if(n)if((s=L.call(n))==E){if((n-=n%1)>0)for(o="",n>10&&(n=10);o.length<n;o+=" ");}else s==C&&(o=n.length<=10?n:n.slice(0,10));return j("",(l={},l[""]=t,l),i,a,o,"",[])}}if(!o("json-parse")){var P,N,I=a.fromCharCode,z={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},F=function(){throw P=N=null,u()},q=function(){for(var t,e,n,o,i,r=N,a=r.length;a>P;)switch(i=r.charCodeAt(P)){case 9:case 10:case 13:case 32:P++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=x?r.charAt(P):r[P],P++,t;case 34:for(t="@",P++;a>P;)if(i=r.charCodeAt(P),32>i)F();else if(92==i)switch(i=r.charCodeAt(++P)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=z[i],P++;break;case 117:for(e=++P,n=P+4;n>P;P++)i=r.charCodeAt(P),i>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||F();t+=I("0x"+r.slice(e,P));break;default:F()}else{if(34==i)break;for(i=r.charCodeAt(P),e=P;i>=32&&92!=i&&34!=i;)i=r.charCodeAt(++P);t+=r.slice(e,P)}if(34==r.charCodeAt(P))return P++,t;F();default:if(e=P,45==i&&(o=!0,i=r.charCodeAt(++P)),i>=48&&57>=i){for(48==i&&(i=r.charCodeAt(P+1),i>=48&&57>=i)&&F(),o=!1;a>P&&(i=r.charCodeAt(P),i>=48&&57>=i);P++);if(46==r.charCodeAt(P)){for(n=++P;a>n&&(i=r.charCodeAt(n),i>=48&&57>=i);n++);n==P&&F(),P=n}if(i=r.charCodeAt(P),101==i||69==i){for(i=r.charCodeAt(++P),(43==i||45==i)&&P++,n=P;a>n&&(i=r.charCodeAt(n),i>=48&&57>=i);n++);n==P&&F(),P=n}return+r.slice(e,P)}if(o&&F(),"true"==r.slice(P,P+4))return P+=4,!0;if("false"==r.slice(P,P+5))return P+=5,!1;if("null"==r.slice(P,P+4))return P+=4,null;F()}return"$"},B=function(t){var e,n;if("$"==t&&F(),"string"==typeof t){if("@"==(x?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=q(),"]"!=t;n||(n=!0))n&&(","==t?(t=q(),"]"==t&&F()):F()),","==t&&F(),e.push(B(t));return e}if("{"==t){for(e={};t=q(),"}"!=t;n||(n=!0))n&&(","==t?(t=q(),"}"==t&&F()):F()),(","==t||"string"!=typeof t||"@"!=(x?t.charAt(0):t[0])||":"!=q())&&F(),e[t.slice(1)]=B(q());return e}F()}return t},J=function(t,e,n){var o=G(t,e,n);o===g?delete t[e]:t[e]=o},G=function(t,e,n){var o,i=t[e];if("object"==typeof i&&i)if(L.call(i)==w)for(o=i.length;o--;)J(i,o,n);else m(i,function(t){J(i,t,n)});return n.call(t,e,i)};n.parse=function(t,e){var n,o;return P=0,N=""+t,n=B(q()),"$"!=q()&&F(),P=N=null,e&&L.call(e)==b?G((o={},o[""]=n,o),"",e):n}}}return n.runInContext=t,n}var i="function"==typeof define&&define.amd,r={"function":!0,object:!0},a=r[typeof n]&&n&&!n.nodeType&&n,s=r[typeof window]&&window||this,l=a&&r[typeof e]&&e&&!e.nodeType&&"object"==typeof o&&o;if(!l||l.global!==l&&l.window!==l&&l.self!==l||(s=l),a&&!i)t(s,a);else{var c=s.JSON,u=s.JSON3,h=!1,p=t(s,s.JSON3={noConflict:function(){return h||(h=!0,s.JSON=c,s.JSON3=u,c=u=null),p}});s.JSON={parse:p.parse,stringify:p.stringify}}i&&define(function(){return p})}).call(this)},{}],4:[function(t,e,n){!function(t,e){if("object"==typeof n&&n)e(n);else{var o={};e(o),"function"==typeof define&&define.amd?define(o):t.Mustache=o}}(this,function(t){function e(t,e){return v.call(t,e)}function n(t){return!e(g,t)}function o(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(t){return String(t).replace(/[&<>"'\/]/g,function(t){return E[t]})}function a(t){this.string=t,this.tail=t,this.pos=0}function s(t,e){this.view=null==t?{}:t,this.parent=e,this._cache={".":this.view}}function l(){this.clearCache()}function c(e,n,i,r){function a(t){return n.render(t,i)}for(var s,l,u,h="",p=0,f=e.length;f>p;++p)switch(s=e[p],l=s[1],s[0]){case"#":if(u=i.lookup(l),"object"==typeof u||"string"==typeof u)if(T(u))for(var d=0,m=u.length;m>d;++d)h+=c(s[4],n,i.push(u[d]),r);else u&&(h+=c(s[4],n,i.push(u),r));else if(o(u)){var g=null==r?null:r.slice(s[3],s[5]);u=u.call(i.view,g,a),null!=u&&(h+=u)}else u&&(h+=c(s[4],n,i,r));break;case"^":u=i.lookup(l),(!u||T(u)&&0===u.length)&&(h+=c(s[4],n,i,r));break;case">":u=n.getPartial(l),o(u)&&(h+=u(i));break;case"&":u=i.lookup(l),null!=u&&(h+=u);break;case"name":u=i.lookup(l),null!=u&&(h+=t.escape(u));break;case"text":h+=l}return h}function u(t){for(var e,n=[],o=n,i=[],r=0,a=t.length;a>r;++r)switch(e=t[r],e[0]){case"#":case"^":i.push(e),o.push(e),o=e[4]=[];break;case"/":var s=i.pop();s[5]=e[2],o=i.length>0?i[i.length-1][4]:n;break;default:o.push(e)}return n}function h(t){for(var e,n,o=[],i=0,r=t.length;r>i;++i)e=t[i],e&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(n=e,o.push(e)));return o}function p(t){return[new RegExp(i(t[0])+"\\s*"),new RegExp("\\s*"+i(t[1]))]}function f(e,o){function r(){if(M&&!x)for(;w.length;)delete C[w.pop()];else w=[];M=!1,x=!1}if(e=e||"",o=o||t.tags,"string"==typeof o&&(o=o.split(m)),2!==o.length)throw new Error("Invalid tags: "+o.join(", "));for(var s,l,c,f,g,v,b=p(o),T=new a(e),E=[],C=[],w=[],M=!1,x=!1;!T.eos();){if(s=T.pos,c=T.scanUntil(b[0]))for(var S=0,k=c.length;k>S;++S)f=c.charAt(S),n(f)?w.push(C.length):x=!0,C.push(["text",f,s,s+1]),s+=1,"\n"==f&&r();if(!T.scan(b[0]))break;if(M=!0,l=T.scan(y)||"name",T.scan(d),"="===l?(c=T.scanUntil(_),T.scan(_),T.scanUntil(b[1])):"{"===l?(c=T.scanUntil(new RegExp("\\s*"+i("}"+o[1]))),T.scan(L),T.scanUntil(b[1]),l="&"):c=T.scanUntil(b[1]),!T.scan(b[1]))throw new Error("Unclosed tag at "+T.pos);if(g=[l,c,s,T.pos],C.push(g),"#"===l||"^"===l)E.push(g);else if("/"===l){if(v=E.pop(),!v)throw new Error('Unopened section "'+c+'" at '+s);if(v[1]!==c)throw new Error('Unclosed section "'+v[1]+'" at '+s)}else if("name"===l||"{"===l||"&"===l)x=!0;else if("="===l){if(o=c.split(m),2!==o.length)throw new Error("Invalid tags at "+s+": "+o.join(", "));b=p(o)}}if(v=E.pop())throw new Error('Unclosed section "'+v[1]+'" at '+T.pos);return u(h(C))}var d=/\s*/,m=/\s+/,g=/\S/,_=/\s*=/,L=/\s*\}/,y=/#|\^|\/|>|\{|&|=|!/,v=RegExp.prototype.test,b=Object.prototype.toString,T=Array.isArray||function(t){return"[object Array]"===b.call(t)},E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};a.prototype.eos=function(){return""===this.tail},a.prototype.scan=function(t){var e=this.tail.match(t);if(e&&0===e.index){var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n}return""},a.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},s.make=function(t){return t instanceof s?t:new s(t)},s.prototype.push=function(t){return new s(t,this)},s.prototype.lookup=function(t){var e;if(t in this._cache)e=this._cache[t];else{for(var n=this;n;){if(t.indexOf(".")>0){e=n.view;for(var i=t.split("."),r=0;null!=e&&r<i.length;)e=e[i[r++]]}else e=n.view[t];if(null!=e)break;n=n.parent}this._cache[t]=e}return o(e)&&(e=e.call(this.view)),e},l.prototype.clearCache=function(){this._cache={},this._partialCache={}},l.prototype.compile=function(e,n){var o=this._cache[e];if(!o){var i=t.parse(e,n);o=this._cache[e]=this.compileTokens(i,e)}return o},l.prototype.compilePartial=function(t,e,n){var o=this.compile(e,n);return this._partialCache[t]=o,o},l.prototype.getPartial=function(t){return t in this._partialCache||!this._loadPartial||this.compilePartial(t,this._loadPartial(t)),this._partialCache[t]},l.prototype.compileTokens=function(t,e){var n=this;return function(i,r){if(r)if(o(r))n._loadPartial=r;else for(var a in r)n.compilePartial(a,r[a]);return c(t,n,s.make(i),e)}},l.prototype.render=function(t,e,n){return this.compile(t)(e,n)},t.name="mustache.js",t.version="0.7.3",t.tags=["{{","}}"],t.Scanner=a,t.Context=s,t.Writer=l,t.parse=f,t.escape=r;var C=new l;t.clearCache=function(){return C.clearCache()},t.compile=function(t,e){return C.compile(t,e)},t.compilePartial=function(t,e,n){return C.compilePartial(t,e,n)},t.compileTokens=function(t,e){return C.compileTokens(t,e)},t.render=function(t,e,n){return C.render(t,e,n)},t.to_html=function(e,n,i,r){var a=t.render(e,n,i);return o(r)?(r(a),void 0):a}})},{}],5:[function(t,e){function n(t){"use strict";return/^https?/.test(t.getScheme())?t.toString():"data"==t.getScheme()&&/^image/.test(t.getPath())?t.toString():void 0}function o(t){return t}var i=t("./sanitizer-bundle.js");e.exports=function(t){return t?i(t,n,o):""}},{"./sanitizer-bundle.js":6}],6:[function(t,e){var n=function(){function t(t){var e=(""+t).match(f);return e?new l(c(e[1]),c(e[2]),c(e[3]),c(e[4]),c(e[5]),c(e[6]),c(e[7])):null}function e(t,e,r,a,s,c,u){var h=new l(o(t,d),o(e,d),n(r),a>0?a.toString():null,o(s,m),null,n(u));return c&&("string"==typeof c?h.setRawQuery(c.replace(/[^?&=0-9A-Za-z_\-~.%]/g,i)):h.setAllParameters(c)),h}function n(t){return"string"==typeof t?encodeURIComponent(t):null}function o(t,e){return"string"==typeof t?encodeURI(t).replace(e,i):null}function i(t){var e=t.charCodeAt(0);return"%"+"0123456789ABCDEF".charAt(e>>4&15)+"0123456789ABCDEF".charAt(15&e)}function r(t){return t.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/")}function a(t){if(null===t)return null;for(var e,n=r(t),o=h;(e=n.replace(o,"$1"))!=n;n=e);return n}function s(t,e){var n=t.clone(),o=e.hasScheme();o?n.setRawScheme(e.getRawScheme()):o=e.hasCredentials(),o?n.setRawCredentials(e.getRawCredentials()):o=e.hasDomain(),o?n.setRawDomain(e.getRawDomain()):o=e.hasPort();var i=e.getRawPath(),r=a(i);if(o)n.setPort(e.getPort()),r=r&&r.replace(p,"");else if(o=!!i){if(47!==r.charCodeAt(0)){var s=a(n.getRawPath()||"").replace(p,""),l=s.lastIndexOf("/")+1;r=a((l?s.substring(0,l):"")+a(i)).replace(p,"")}}else r=r&&r.replace(p,""),r!==i&&n.setRawPath(r);return o?n.setRawPath(r):o=e.hasQuery(),o?n.setRawQuery(e.getRawQuery()):o=e.hasFragment(),o&&n.setRawFragment(e.getRawFragment()),n}function l(t,e,n,o,i,r,a){this.scheme_=t,this.credentials_=e,this.domain_=n,this.port_=o,this.path_=i,this.query_=r,this.fragment_=a,this.paramCache_=null}function c(t){return"string"==typeof t&&t.length>0?t:null}var u=new RegExp("(/|^)(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)/\\.\\.(?:/|$)"),h=new RegExp(u),p=/^(?:\.\.\/)*(?:\.\.$)?/;l.prototype.toString=function(){var t=[];return null!==this.scheme_&&t.push(this.scheme_,":"),null!==this.domain_&&(t.push("//"),null!==this.credentials_&&t.push(this.credentials_,"@"),t.push(this.domain_),null!==this.port_&&t.push(":",this.port_.toString())),null!==this.path_&&t.push(this.path_),null!==this.query_&&t.push("?",this.query_),null!==this.fragment_&&t.push("#",this.fragment_),t.join("")},l.prototype.clone=function(){return new l(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_)},l.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase()},l.prototype.getRawScheme=function(){return this.scheme_},l.prototype.setScheme=function(t){return this.scheme_=o(t,d),this},l.prototype.setRawScheme=function(t){return this.scheme_=t?t:null,this},l.prototype.hasScheme=function(){return null!==this.scheme_},l.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_)},l.prototype.getRawCredentials=function(){return this.credentials_},l.prototype.setCredentials=function(t){return this.credentials_=o(t,d),this},l.prototype.setRawCredentials=function(t){return this.credentials_=t?t:null,this},l.prototype.hasCredentials=function(){return null!==this.credentials_},l.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_)},l.prototype.getRawDomain=function(){return this.domain_},l.prototype.setDomain=function(t){return this.setRawDomain(t&&encodeURIComponent(t))},l.prototype.setRawDomain=function(t){return this.domain_=t?t:null,this.setRawPath(this.path_)},l.prototype.hasDomain=function(){return null!==this.domain_},l.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_)},l.prototype.setPort=function(t){if(t){if(t=Number(t),t!==(65535&t))throw new Error("Bad port number "+t);this.port_=""+t}else this.port_=null;return this},l.prototype.hasPort=function(){return null!==this.port_},l.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_)},l.prototype.getRawPath=function(){return this.path_},l.prototype.setPath=function(t){return this.setRawPath(o(t,m))},l.prototype.setRawPath=function(t){return t?(t=String(t),this.path_=!this.domain_||/^\//.test(t)?t:"/"+t):this.path_=null,this},l.prototype.hasPath=function(){return null!==this.path_},l.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g," ")},l.prototype.getRawQuery=function(){return this.query_},l.prototype.setQuery=function(t){return this.paramCache_=null,this.query_=n(t),this},l.prototype.setRawQuery=function(t){return this.paramCache_=null,this.query_=t?t:null,this},l.prototype.hasQuery=function(){return null!==this.query_},l.prototype.setAllParameters=function(t){if("object"==typeof t&&!(t instanceof Array)&&(t instanceof Object||"[object Array]"!==Object.prototype.toString.call(t))){var e=[],n=-1;for(var o in t){var i=t[o];"string"==typeof i&&(e[++n]=o,e[++n]=i)}t=e}this.paramCache_=null;for(var r=[],a="",s=0;s<t.length;){var o=t[s++],i=t[s++];r.push(a,encodeURIComponent(o.toString())),a="&",i&&r.push("=",encodeURIComponent(i.toString()))}return this.query_=r.join(""),this},l.prototype.checkParameterCache_=function(){if(!this.paramCache_){var t=this.query_;if(t){for(var e=t.split(/[&\?]/),n=[],o=-1,i=0;i<e.length;++i){var r=e[i].match(/^([^=]*)(?:=(.*))?$/);n[++o]=decodeURIComponent(r[1]).replace(/\+/g," "),n[++o]=decodeURIComponent(r[2]||"").replace(/\+/g," ")}this.paramCache_=n}else this.paramCache_=[]}},l.prototype.setParameterValues=function(t,e){"string"==typeof e&&(e=[e]),this.checkParameterCache_();for(var n=0,o=this.paramCache_,i=[],r=0;r<o.length;r+=2)t===o[r]?n<e.length&&i.push(t,e[n++]):i.push(o[r],o[r+1]);for(;n<e.length;)i.push(t,e[n++]);return this.setAllParameters(i),this},l.prototype.removeParameter=function(t){return this.setParameterValues(t,[])},l.prototype.getAllParameters=function(){return this.checkParameterCache_(),this.paramCache_.slice(0,this.paramCache_.length)},l.prototype.getParameterValues=function(t){this.checkParameterCache_();for(var e=[],n=0;n<this.paramCache_.length;n+=2)t===this.paramCache_[n]&&e.push(this.paramCache_[n+1]);return e},l.prototype.getParameterMap=function(){this.checkParameterCache_();for(var t={},e=0;e<this.paramCache_.length;e+=2){var n=this.paramCache_[e++],o=this.paramCache_[e++];n in t?t[n].push(o):t[n]=[o]}return t},l.prototype.getParameterValue=function(t){this.checkParameterCache_();for(var e=0;e<this.paramCache_.length;e+=2)if(t===this.paramCache_[e])return this.paramCache_[e+1];return null},l.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_)},l.prototype.getRawFragment=function(){return this.fragment_},l.prototype.setFragment=function(t){return this.fragment_=t?encodeURIComponent(t):null,this},l.prototype.setRawFragment=function(t){return this.fragment_=t?t:null,this},l.prototype.hasFragment=function(){return null!==this.fragment_};var f=new RegExp("^(?:([^:/?#]+):)?(?://(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),d=/[#\/\?@]/g,m=/[\#\?]/g;return l.parse=t,l.create=e,l.resolve=s,l.collapse_dots=a,l.utils={mimeTypeOf:function(e){var n=t(e);return/\.html$/.test(n.getPath())?"text/html":"application/javascript"},resolve:function(e,n){return e?s(t(e),t(n)).toString():""+n}},l}(),o={};if(o.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13},o.atype=o.atype,o.ATTRIBS={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,"audio::muted":0,"audio::preload":0,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"select::tabindex":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,"textarea::rows":0,"textarea::tabindex":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::width":0},o.ATTRIBS=o.ATTRIBS,o.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256},o.eflags=o.eflags,o.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,"var":0,video:0,wbr:2},o.ELEMENTS=o.ELEMENTS,o.ELEMENT_DOM_INTERFACES={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement","var":"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"},o.ELEMENT_DOM_INTERFACES=o.ELEMENT_DOM_INTERFACES,o.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2},o.ueffects=o.ueffects,o.URIEFFECTS={"a::href":2,"area::href":2,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1},o.URIEFFECTS=o.URIEFFECTS,o.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0},o.ltypes=o.ltypes,o.LOADERTYPES={"a::href":2,"area::href":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1},o.LOADERTYPES=o.LOADERTYPES,"i"!=="I".toLowerCase())throw"I/i problem";
var i=function(t){function e(t){if(H.hasOwnProperty(t))return H[t];var e=t.match(A);if(e)return String.fromCharCode(parseInt(e[1],10));if(e=t.match(R))return String.fromCharCode(parseInt(e[1],16));if(O&&U.test(t)){O.innerHTML="&"+t+";";var n=O.textContent;return H[t]=n,n}return"&"+t+";"}function o(t,n){return e(n)}function i(t){return t.replace(j,"")}function r(t){return t.replace(P,o)}function a(t){return(""+t).replace(I,"&amp;").replace(F,"&lt;").replace(q,"&gt;").replace(B,"&#34;")}function s(t){return t.replace(z,"&amp;$1").replace(F,"&lt;").replace(q,"&gt;")}function l(t){var e={cdata:t.cdata||t.cdata,comment:t.comment||t.comment,endDoc:t.endDoc||t.endDoc,endTag:t.endTag||t.endTag,pcdata:t.pcdata||t.pcdata,rcdata:t.rcdata||t.rcdata,startDoc:t.startDoc||t.startDoc,startTag:t.startTag||t.startTag};return function(t,n){return c(t,e,n)}}function c(t,e,n){var o=p(t),i={noMoreGT:!1,noMoreEndComments:!1};h(e,o,0,i,n)}function u(t,e,n,o,i){return function(){h(t,e,n,o,i)}}function h(e,n,o,i,r){try{e.startDoc&&0==o&&e.startDoc(r);for(var a,s,l,c=o,h=n.length;h>c;){var p=n[c++],g=n[c];switch(p){case"&":N.test(g)?(e.pcdata&&e.pcdata("&"+g,r,$,u(e,n,c,i,r)),c++):e.pcdata&&e.pcdata("&amp;",r,$,u(e,n,c,i,r));break;case"</":(a=/^([-\w:]+)[^\'\"]*/.exec(g))?a[0].length===g.length&&">"===n[c+1]?(c+=2,l=a[1].toLowerCase(),e.endTag&&e.endTag(l,r,$,u(e,n,c,i,r))):c=f(n,c,e,r,$,i):e.pcdata&&e.pcdata("&lt;/",r,$,u(e,n,c,i,r));break;case"<":if(a=/^([-\w:]+)\s*\/?/.exec(g))if(a[0].length===g.length&&">"===n[c+1]){c+=2,l=a[1].toLowerCase(),e.startTag&&e.startTag(l,[],r,$,u(e,n,c,i,r));var _=t.ELEMENTS[l];if(_&Z){var L={name:l,next:c,eflags:_};c=m(n,L,e,r,$,i)}}else c=d(n,c,e,r,$,i);else e.pcdata&&e.pcdata("&lt;",r,$,u(e,n,c,i,r));break;case"<!--":if(!i.noMoreEndComments){for(s=c+1;h>s&&(">"!==n[s]||!/--$/.test(n[s-1]));s++);if(h>s){if(e.comment){var y=n.slice(c,s).join("");e.comment(y.substr(0,y.length-2),r,$,u(e,n,s+1,i,r))}c=s+1}else i.noMoreEndComments=!0}i.noMoreEndComments&&e.pcdata&&e.pcdata("&lt;!--",r,$,u(e,n,c,i,r));break;case"<!":if(/^\w/.test(g)){if(!i.noMoreGT){for(s=c+1;h>s&&">"!==n[s];s++);h>s?c=s+1:i.noMoreGT=!0}i.noMoreGT&&e.pcdata&&e.pcdata("&lt;!",r,$,u(e,n,c,i,r))}else e.pcdata&&e.pcdata("&lt;!",r,$,u(e,n,c,i,r));break;case"<?":if(!i.noMoreGT){for(s=c+1;h>s&&">"!==n[s];s++);h>s?c=s+1:i.noMoreGT=!0}i.noMoreGT&&e.pcdata&&e.pcdata("&lt;?",r,$,u(e,n,c,i,r));break;case">":e.pcdata&&e.pcdata("&gt;",r,$,u(e,n,c,i,r));break;case"":break;default:e.pcdata&&e.pcdata(p,r,$,u(e,n,c,i,r))}}e.endDoc&&e.endDoc(r)}catch(v){if(v!==$)throw v}}function p(t){var e=/(<\/|<\!--|<[!?]|[&<>])/g;if(t+="",G)return t.split(e);for(var n,o=[],i=0;null!==(n=e.exec(t));)o.push(t.substring(i,n.index)),o.push(n[0]),i=n.index+n[0].length;return o.push(t.substring(i)),o}function f(t,e,n,o,i,r){var a=g(t,e);return a?(n.endTag&&n.endTag(a.name,o,i,u(n,t,e,r,o)),a.next):t.length}function d(t,e,n,o,i,r){var a=g(t,e);return a?(n.startTag&&n.startTag(a.name,a.attrs,o,i,u(n,t,a.next,r,o)),a.eflags&Z?m(t,a,n,o,i,r):a.next):t.length}function m(e,n,o,i,r,a){var l=e.length;Y.hasOwnProperty(n.name)||(Y[n.name]=new RegExp("^"+n.name+"(?:[\\s\\/]|$)","i"));for(var c=Y[n.name],h=n.next,p=n.next+1;l>p&&("</"!==e[p-1]||!c.test(e[p]));p++);l>p&&(p-=1);var f=e.slice(h,p).join("");if(n.eflags&t.eflags.CDATA)o.cdata&&o.cdata(f,i,r,u(o,e,p,a,i));else{if(!(n.eflags&t.eflags.RCDATA))throw new Error("bug");o.rcdata&&o.rcdata(s(f),i,r,u(o,e,p,a,i))}return p}function g(e,n){var o=/^([-\w:]+)/.exec(e[n]),i={};i.name=o[1].toLowerCase(),i.eflags=t.ELEMENTS[i.name];for(var r=e[n].substr(o[0].length),a=n+1,s=e.length;s>a&&">"!==e[a];a++)r+=e[a];if(a>=s)return void 0;for(var l=[];""!==r;)if(o=J.exec(r)){if(o[4]&&!o[5]||o[6]&&!o[7]){for(var c=o[4]||o[6],u=!1,h=[r,e[a++]];s>a;a++){if(u){if(">"===e[a])break}else 0<=e[a].indexOf(c)&&(u=!0);h.push(e[a])}if(a>=s)break;r=h.join("");continue}var p=o[1].toLowerCase(),f=o[2]?_(o[3]):"";l.push(p,f),r=r.substr(o[0].length)}else r=r.replace(/^[\s\S][^a-z\s]*/,"");return i.attrs=l,i.next=a+1,i}function _(t){var e=t.charCodeAt(0);return(34===e||39===e)&&(t=t.substr(1,t.length-2)),r(i(t))}function L(e){var n,o,i=function(t,e){o||e.push(t)};return l({startDoc:function(){n=[],o=!1},startTag:function(i,r,s){if(!o&&t.ELEMENTS.hasOwnProperty(i)){var l=t.ELEMENTS[i];if(!(l&t.eflags.FOLDABLE)){var c=e(i,r);if(!c)return o=!(l&t.eflags.EMPTY),void 0;if("object"!=typeof c)throw new Error("tagPolicy did not return object (old API?)");if(!("attribs"in c))throw new Error("tagPolicy gave no attribs");r=c.attribs;var u,h;if("tagName"in c?(h=c.tagName,u=t.ELEMENTS[h]):(h=i,u=l),l&t.eflags.OPTIONAL_ENDTAG){var p=n[n.length-1];!p||p.orig!==i||p.rep===h&&i===h||s.push("</",p.rep,">")}l&t.eflags.EMPTY||n.push({orig:i,rep:h}),s.push("<",h);for(var f=0,d=r.length;d>f;f+=2){var m=r[f],g=r[f+1];null!==g&&void 0!==g&&s.push(" ",m,'="',a(g),'"')}s.push(">"),l&t.eflags.EMPTY&&!(u&t.eflags.EMPTY)&&s.push("</",h,">")}}},endTag:function(e,i){if(o)return o=!1,void 0;if(t.ELEMENTS.hasOwnProperty(e)){var r=t.ELEMENTS[e];if(!(r&(t.eflags.EMPTY|t.eflags.FOLDABLE))){var a;if(r&t.eflags.OPTIONAL_ENDTAG)for(a=n.length;--a>=0;){var s=n[a].orig;if(s===e)break;if(!(t.ELEMENTS[s]&t.eflags.OPTIONAL_ENDTAG))return}else for(a=n.length;--a>=0&&n[a].orig!==e;);if(0>a)return;for(var l=n.length;--l>a;){var c=n[l].rep;t.ELEMENTS[c]&t.eflags.OPTIONAL_ENDTAG||i.push("</",c,">")}a<n.length&&(e=n[a].rep),n.length=a,i.push("</",e,">")}}},pcdata:i,rcdata:i,cdata:i,endDoc:function(t){for(;n.length;n.length--)t.push("</",n[n.length-1].rep,">")}})}function y(t,e,o,i,r){if(!r)return null;try{var a=n.parse(""+t);if(a&&(!a.hasScheme()||V.test(a.getScheme()))){var s=r(a,e,o,i);return s?s.toString():null}}catch(l){return null}return null}function v(t,e,n,o,i){if(n||t(e+" removed",{change:"removed",tagName:e}),o!==i){var r="changed";o&&!i?r="removed":!o&&i&&(r="added"),t(e+"."+n+" "+r,{change:r,tagName:e,attribName:n,oldValue:o,newValue:i})}}function b(t,e,n){var o;return o=e+"::"+n,t.hasOwnProperty(o)?t[o]:(o="*::"+n,t.hasOwnProperty(o)?t[o]:void 0)}function T(e,n){return b(t.LOADERTYPES,e,n)}function E(e,n){return b(t.URIEFFECTS,e,n)}function C(e,n,o,i,r){for(var a=0;a<n.length;a+=2){var s,l=n[a],c=n[a+1],u=c,h=null;if(s=e+"::"+l,(t.ATTRIBS.hasOwnProperty(s)||(s="*::"+l,t.ATTRIBS.hasOwnProperty(s)))&&(h=t.ATTRIBS[s]),null!==h)switch(h){case t.atype.NONE:break;case t.atype.SCRIPT:c=null,r&&v(r,e,l,u,c);break;case t.atype.STYLE:if("undefined"==typeof S){c=null,r&&v(r,e,l,u,c);break}var p=[];S(c,{declaration:function(e,n){var i=e.toLowerCase(),r=D[i];r&&(k(i,r,n,o?function(e){return y(e,t.ueffects.SAME_DOCUMENT,t.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:i},o)}:null),p.push(e+": "+n.join(" ")))}}),c=p.length>0?p.join(" ; "):null,r&&v(r,e,l,u,c);break;case t.atype.ID:case t.atype.IDREF:case t.atype.IDREFS:case t.atype.GLOBAL_NAME:case t.atype.LOCAL_NAME:case t.atype.CLASSES:c=i?i(c):c,r&&v(r,e,l,u,c);break;case t.atype.URI:c=y(c,E(e,l),T(e,l),{TYPE:"MARKUP",XML_ATTR:l,XML_TAG:e},o),r&&v(r,e,l,u,c);break;case t.atype.URI_FRAGMENT:c&&"#"===c.charAt(0)?(c=c.substring(1),c=i?i(c):c,null!==c&&void 0!==c&&(c="#"+c)):c=null,r&&v(r,e,l,u,c);break;default:c=null,r&&v(r,e,l,u,c)}else c=null,r&&v(r,e,l,u,c);n[a+1]=c}return n}function w(e,n,o){return function(i,r){return t.ELEMENTS[i]&t.eflags.UNSAFE?(o&&v(o,i,void 0,void 0,void 0),void 0):{attribs:C(i,r,e,n,o)}}}function M(t,e){var n=[];return L(e)(t,n),n.join("")}function x(t,e,n,o){var i=w(e,n,o);return M(t,i)}var S,k,D;"undefined"!=typeof window&&(S=window.parseCssDeclarations,k=window.sanitizeCssProperty,D=window.cssSchema);var H={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:"Â "},A=/^#(\d+)$/,R=/^#x([0-9A-Fa-f]+)$/,U=/^[A-Za-z][A-za-z0-9]+$/,O="undefined"!=typeof window&&window.document?window.document.createElement("textarea"):null,j=/\0/g,P=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,N=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,I=/&/g,z=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,F=/[<]/g,q=/>/g,B=/\"/g,J=new RegExp("^\\s*([-.:\\w]+)(?:\\s*(=)\\s*((\")[^\"]*(\"|$)|(')[^']*('|$)|(?=[a-z][-\\w]*\\s*=)|[^\"'\\s]*))?","i"),G=3==="a,b".split(/(,)/).length,Z=t.eflags.CDATA|t.eflags.RCDATA,$={},Y={},V=/^(?:https?|mailto|data)$/i,Q={};return Q.escapeAttrib=Q.escapeAttrib=a,Q.makeHtmlSanitizer=Q.makeHtmlSanitizer=L,Q.makeSaxParser=Q.makeSaxParser=l,Q.makeTagPolicy=Q.makeTagPolicy=w,Q.normalizeRCData=Q.normalizeRCData=s,Q.sanitize=Q.sanitize=x,Q.sanitizeAttribs=Q.sanitizeAttribs=C,Q.sanitizeWithPolicy=Q.sanitizeWithPolicy=M,Q.unescapeEntities=Q.unescapeEntities=r,Q}(o),r=i.sanitize;o.ATTRIBS["*::style"]=0,o.ELEMENTS.style=0,o.ATTRIBS["a::target"]=0,o.ELEMENTS.video=0,o.ATTRIBS["video::src"]=0,o.ATTRIBS["video::poster"]=0,o.ATTRIBS["video::controls"]=0,o.ELEMENTS.audio=0,o.ATTRIBS["audio::src"]=0,o.ATTRIBS["video::autoplay"]=0,o.ATTRIBS["video::controls"]=0,"undefined"!=typeof e&&(e.exports=r)},{}],7:[function(t,e){e.exports={author:"Mapbox",name:"mapbox.js",description:"mapbox javascript api",version:"1.6.3",homepage:"http://mapbox.com/",repository:{type:"git",url:"git://github.com/mapbox/mapbox.js.git"},main:"index.js",dependencies:{leaflet:"0.7.2",mustache:"0.7.3",corslite:"0.0.5",json3:"3.3.1","sanitize-caja":"0.0.0"},scripts:{test:"jshint src/*.js && mocha-phantomjs test/index.html"},devDependencies:{"leaflet-hash":"0.2.1","leaflet-fullscreen":"0.0.0","uglify-js":"2.4.8",mocha:"1.17.1","expect.js":"0.3.1",sinon:"1.8.2","mocha-phantomjs":"3.1.6",happen:"0.1.3",browserify:"3.23.1",jshint:"2.4.4","clean-css":"~2.0.7",minimist:"0.0.5",marked:"~0.3.0"},optionalDependencies:{},engines:{node:"*"}}},{}],8:[function(t,e){"use strict";e.exports={HTTP_URLS:["http://a.tiles.mapbox.com/v3/","http://b.tiles.mapbox.com/v3/"],FORCE_HTTPS:!1,HTTPS_URLS:["https://a.tiles.mapbox.com/v3/","https://b.tiles.mapbox.com/v3/"]}},{}],9:[function(t,e){"use strict";var n=t("./util"),o=t("./url"),i=t("./request"),r=t("./marker"),a=t("./simplestyle"),s=L.FeatureGroup.extend({options:{filter:function(){return!0},sanitizer:t("sanitize-caja"),style:a.style},initialize:function(t,e){L.setOptions(this,e),this._layers={},"string"==typeof t?n.idUrl(t,this):t&&"object"==typeof t&&this.setGeoJSON(t)},setGeoJSON:function(t){return this._geojson=t,this.clearLayers(),this._initialize(t),this},getGeoJSON:function(){return this._geojson},loadURL:function(t){return this._request&&"abort"in this._request&&this._request.abort(),t=o.jsonify(t),this._request=i(t,L.bind(function(e,o){this._request=null,e&&"abort"!==e.type?(n.log("could not load features at "+t),this.fire("error",{error:e})):o&&(this.setGeoJSON(o),this.fire("ready"))},this)),this},loadID:function(t){return this.loadURL(o.base()+t+"/markers.geojson")},setFilter:function(t){return this.options.filter=t,this._geojson&&(this.clearLayers(),this._initialize(this._geojson)),this},getFilter:function(){return this.options.filter},_initialize:function(t){var e,n,o=L.Util.isArray(t)?t:t.features;if(o)for(e=0,n=o.length;n>e;e++)(o[e].geometries||o[e].geometry||o[e].features)&&this._initialize(o[e]);else if(this.options.filter(t)){var i=L.GeoJSON.geometryToLayer(t,r.style),s=r.createPopup(t,this.options.sanitizer);"setStyle"in i&&i.setStyle(a.style(t)),i.feature=t,s&&i.bindPopup(s,{closeButton:!1}),this.addLayer(i)}}});e.exports.FeatureLayer=s,e.exports.featureLayer=function(t,e){return new s(t,e)}},{"./marker":19,"./request":20,"./simplestyle":22,"./url":24,"./util":25,"sanitize-caja":5}],10:[function(t,e){"use strict";var n=t("./util"),o=t("./url"),i=t("./request");e.exports=function(t){var e,r={};return r.getURL=function(){return e},r.setURL=function(t){return e=o.jsonify(t),r},r.setID=function(t){return n.strict(t,"string"),r.setURL(o.base()+t+"/geocode/{query}.json"),r},r.setTileJSON=function(t){return n.strict(t,"object"),r.setURL(t.geocoder),r},r.queryURL=function(t){if(!r.getURL())throw new Error("Geocoding map ID not set");if("string"!=typeof t){for(var e=[],n=0;n<t.length;n++)e[n]=encodeURIComponent(t[n]);return L.Util.template(r.getURL(),{query:e.join(";")})}return L.Util.template(r.getURL(),{query:encodeURIComponent(t)})},r.query=function(t,e){return n.strict(e,"function"),i(r.queryURL(t),function(t,o){if(o&&(o.length||o.results)){var i={results:o.length?o:o.results};o.results&&(i.latlng=[o.results[0][0].lat,o.results[0][0].lon]),o.results&&void 0!==o.results[0][0].bounds&&(i.bounds=o.results[0][0].bounds,i.lbounds=n.lbounds(i.bounds)),e(null,i)}else e(t||!0)}),r},r.reverseQuery=function(t,e){function n(t){return void 0!==t.lat&&void 0!==t.lng?t.lng+","+t.lat:void 0!==t.lat&&void 0!==t.lon?t.lon+","+t.lat:t[0]+","+t[1]}var o="";if(t.length&&t[0].length){for(var a=0,s=[];a<t.length;a++)s.push(n(t[a]));o=s.join(";")}else o=n(t);return i(r.queryURL(o),function(t,n){e(t,n)}),r},"string"==typeof t?-1==t.indexOf("/")?r.setID(t):r.setURL(t):"object"==typeof t&&r.setTileJSON(t),r}},{"./request":20,"./url":24,"./util":25}],11:[function(t,e){"use strict";var n=t("./geocoder"),o=L.Control.extend({includes:L.Mixin.Events,options:{position:"topleft",pointZoom:16,keepOpen:!1},initialize:function(t,e){L.Util.setOptions(this,e),this.geocoder=n(t)},setURL:function(t){return this.geocoder.setURL(t),this},getURL:function(){return this.geocoder.getURL()},setID:function(t){return this.geocoder.setID(t),this},setTileJSON:function(t){return this.geocoder.setTileJSON(t),this},_toggle:function(t){t&&L.DomEvent.stop(t),L.DomUtil.hasClass(this._container,"active")?(L.DomUtil.removeClass(this._container,"active"),this._results.innerHTML="",this._input.blur()):(L.DomUtil.addClass(this._container,"active"),this._input.focus(),this._input.select())},_closeIfOpen:function(){L.DomUtil.hasClass(this._container,"active")&&!this.options.keepOpen&&(L.DomUtil.removeClass(this._container,"active"),this._results.innerHTML="",this._input.blur())},onAdd:function(t){var e=L.DomUtil.create("div","leaflet-control-mapbox-geocoder leaflet-bar leaflet-control"),n=L.DomUtil.create("a","leaflet-control-mapbox-geocoder-toggle mapbox-icon mapbox-icon-geocoder",e),o=L.DomUtil.create("div","leaflet-control-mapbox-geocoder-results",e),i=L.DomUtil.create("div","leaflet-control-mapbox-geocoder-wrap",e),r=L.DomUtil.create("form","leaflet-control-mapbox-geocoder-form",i),a=L.DomUtil.create("input","",r);return n.href="#",n.innerHTML="&nbsp;",a.type="text",a.setAttribute("placeholder","Search"),L.DomEvent.addListener(r,"submit",this._geocode,this),L.DomEvent.disableClickPropagation(e),this._map=t,this._results=o,this._input=a,this._form=r,this.options.keepOpen?L.DomUtil.addClass(e,"active"):(this._map.on("click",this._closeIfOpen,this),L.DomEvent.addListener(n,"click",this._toggle,this)),e},_geocode:function(t){L.DomEvent.preventDefault(t),L.DomUtil.addClass(this._container,"searching");var e=this._map,n=L.bind(function(t,e){if(L.DomUtil.removeClass(this._container,"searching"),!t&&e&&e.results&&e.results.length){if(this._results.innerHTML="",1===e.results.length)this.fire("autoselect",{data:e}),o(e.results[0][0]),this._closeIfOpen();else{for(var n=0,i=Math.min(e.results.length,5);i>n;n++){for(var r=[],a=0;a<e.results[n].length;a++)e.results[n][a].name&&r.push(e.results[n][a].name);if(r.length){var s=L.DomUtil.create("a","",this._results);s.innerHTML=r.join(", "),s.href="#",L.bind(function(t){L.DomEvent.addListener(s,"click",function(e){o(t[0]),L.DomEvent.stop(e),this.fire("select",{data:t})},this)},this)(e.results[n])}}if(e.results.length>5){var l=L.DomUtil.create("span","",this._results);l.innerHTML="Top 5 of "+e.results.length+"  results"}}this.fire("found",e)}else this.fire("error",{error:t})},this),o=L.bind(function(t){if(t.bounds){var n=t.bounds;this._map.fitBounds(L.latLngBounds([[n[1],n[0]],[n[3],n[2]]]))}else void 0!==t.lat&&void 0!==t.lon&&this._map.setView([t.lat,t.lon],void 0===e.getZoom()?this.options.pointZoom:Math.max(e.getZoom(),this.options.pointZoom))},this);this.geocoder.query(this._input.value,n)}});e.exports.GeocoderControl=o,e.exports.geocoderControl=function(t,e){return new o(t,e)}},{"./geocoder":10}],12:[function(t,e){"use strict";function n(t){return t>=93&&t--,t>=35&&t--,t-32}e.exports=function(t){return function(e,o){if(t){var i=n(t.grid[o].charCodeAt(e)),r=t.keys[i];return t.data[r]}}}},{}],13:[function(t,e){"use strict";var n=t("./util"),o=t("mustache"),i=L.Control.extend({options:{pinnable:!0,follow:!1,sanitizer:t("sanitize-caja"),touchTeaser:!0,location:!0},_currentContent:"",_pinned:!1,initialize:function(t,e){L.Util.setOptions(this,e),n.strict_instance(t,L.Class,"L.mapbox.gridLayer"),this._layer=t},setTemplate:function(t){return n.strict(t,"string"),this.options.template=t,this},_template:function(t,e){if(e){var n=this.options.template||this._layer.getTileJSON().template;if(n){var i={};return i["__"+t+"__"]=!0,this.options.sanitizer(o.to_html(n,L.extend(i,e)))}}},_show:function(t,e){t!==this._currentContent&&(this._currentContent=t,this.options.follow?(this._popup.setContent(t).setLatLng(e.latLng),this._map._popup!==this._popup&&this._popup.openOn(this._map)):(this._container.style.display="block",this._contentWrapper.innerHTML=t))},hide:function(){return this._pinned=!1,this._currentContent="",this._map.closePopup(),this._container.style.display="none",this._contentWrapper.innerHTML="",L.DomUtil.removeClass(this._container,"closable"),this},_mouseover:function(t){if(t.data?L.DomUtil.addClass(this._map._container,"map-clickable"):L.DomUtil.removeClass(this._map._container,"map-clickable"),!this._pinned){var e=this._template("teaser",t.data);e?this._show(e,t):this.hide()}},_mousemove:function(t){this._pinned||this.options.follow&&this._popup.setLatLng(t.latLng)},_navigateTo:function(t){window.top.location.href=t},_click:function(t){var e=this._template("location",t.data);if(this.options.location&&e&&0===e.search(/^https?:/))return this._navigateTo(this._template("location",t.data));if(this.options.pinnable){var n=this._template("full",t.data);!n&&this.options.touchTeaser&&L.Browser.touch&&(n=this._template("teaser",t.data)),n?(L.DomUtil.addClass(this._container,"closable"),this._pinned=!0,this._show(n,t)):this._pinned&&(L.DomUtil.removeClass(this._container,"closable"),this._pinned=!1,this.hide())}},_onPopupClose:function(){this._currentContent=null,this._pinned=!1},_createClosebutton:function(t,e){var n=L.DomUtil.create("a","close",t);return n.innerHTML="close",n.href="#",n.title="close",L.DomEvent.on(n,"click",L.DomEvent.stopPropagation).on(n,"mousedown",L.DomEvent.stopPropagation).on(n,"dblclick",L.DomEvent.stopPropagation).on(n,"click",L.DomEvent.preventDefault).on(n,"click",e,this),n},onAdd:function(t){this._map=t;var e="leaflet-control-grid map-tooltip",n=L.DomUtil.create("div",e),o=L.DomUtil.create("div","map-tooltip-content");return n.style.display="none",this._createClosebutton(n,this.hide),n.appendChild(o),this._contentWrapper=o,this._popup=new L.Popup({autoPan:!1,closeOnClick:!1}),t.on("popupclose",this._onPopupClose,this),L.DomEvent.disableClickPropagation(n).addListener(n,"mousewheel",L.DomEvent.stopPropagation),this._layer.on("mouseover",this._mouseover,this).on("mousemove",this._mousemove,this).on("click",this._click,this),n},onRemove:function(t){t.off("popupclose",this._onPopupClose,this),this._layer.off("mouseover",this._mouseover,this).off("mousemove",this._mousemove,this).off("click",this._click,this)}});e.exports.GridControl=i,e.exports.gridControl=function(t,e){return new i(t,e)}},{"./util":25,mustache:4,"sanitize-caja":5}],14:[function(t,e){"use strict";var n=t("./util"),o=(t("./url"),t("./request")),i=t("./grid"),r=L.Class.extend({includes:[L.Mixin.Events,t("./load_tilejson")],options:{template:function(){return""}},_mouseOn:null,_tilejson:{},_cache:{},initialize:function(t,e){L.Util.setOptions(this,e),this._loadTileJSON(t)},_setTileJSON:function(t){return n.strict(t,"object"),L.extend(this.options,{grids:t.grids,minZoom:t.minzoom,maxZoom:t.maxzoom,bounds:t.bounds&&n.lbounds(t.bounds)}),this._tilejson=t,this._cache={},this._update(),this},getTileJSON:function(){return this._tilejson},active:function(){return!!(this._map&&this.options.grids&&this.options.grids.length)},addTo:function(t){return t.addLayer(this),this},onAdd:function(t){this._map=t,this._update(),this._map.on("click",this._click,this).on("mousemove",this._move,this).on("moveend",this._update,this)},onRemove:function(){this._map.off("click",this._click,this).off("mousemove",this._move,this).off("moveend",this._update,this)},getData:function(t,e){if(this.active()){var n=this._map,o=n.project(t.wrap()),i=256,r=4,a=Math.floor(o.x/i),s=Math.floor(o.y/i),l=n.options.crs.scale(n.getZoom())/i;return a=(a+l)%l,s=(s+l)%l,this._getTile(n.getZoom(),a,s,function(t){var n=Math.floor((o.x-a*i)/r),l=Math.floor((o.y-s*i)/r);e(t(n,l))}),this}},_click:function(t){this.getData(t.latlng,L.bind(function(e){this.fire("click",{latLng:t.latlng,data:e})},this))},_move:function(t){this.getData(t.latlng,L.bind(function(e){e!==this._mouseOn?(this._mouseOn&&this.fire("mouseout",{latLng:t.latlng,data:this._mouseOn}),this.fire("mouseover",{latLng:t.latlng,data:e}),this._mouseOn=e):this.fire("mousemove",{latLng:t.latlng,data:e})},this))},_getTileURL:function(t){var e=this.options.grids,n=(t.x+t.y)%e.length,o=e[n];return L.Util.template(o,t)},_update:function(){if(this.active()){var t=this._map.getPixelBounds(),e=this._map.getZoom(),n=256;if(!(e>this.options.maxZoom||e<this.options.minZoom))for(var o=new L.Point(Math.floor(t.min.x/n),Math.floor(t.min.y/n)),i=new L.Point(Math.floor(t.max.x/n),Math.floor(t.max.y/n)),r=this._map.options.crs.scale(e)/n,a=o.x;a<=i.x;a++)for(var s=o.y;s<=i.y;s++){var l=(a+r)%r,c=(s+r)%r;this._getTile(e,l,c)}}},_getTile:function(t,e,n,r){var a=t+"_"+e+"_"+n,s=L.point(e,n);if(s.z=t,this._tileShouldBeLoaded(s)){if(a in this._cache){if(!r)return;return"function"==typeof this._cache[a]?r(this._cache[a]):this._cache[a].push(r),void 0}this._cache[a]=[],r&&this._cache[a].push(r),o(this._getTileURL(s),L.bind(function(t,e){var n=this._cache[a];this._cache[a]=i(e);for(var o=0;o<n.length;++o)n[o](this._cache[a])},this))}},_tileShouldBeLoaded:function(t){if(t.z>this.options.maxZoom||t.z<this.options.minZoom)return!1;if(this.options.bounds){var e=256,n=t.multiplyBy(e),o=n.add(new L.Point(e,e)),i=this._map.unproject(n),r=this._map.unproject(o),a=new L.LatLngBounds([i,r]);if(!this.options.bounds.intersects(a))return!1}return!0}});e.exports.GridLayer=r,e.exports.gridLayer=function(t,e){return new r(t,e)}},{"./grid":12,"./load_tilejson":17,"./request":20,"./url":24,"./util":25}],15:[function(t,e){"use strict";var n=L.Control.extend({options:{position:"bottomright",sanitizer:t("sanitize-caja")},initialize:function(t){L.setOptions(this,t),this._info={}},onAdd:function(t){this._container=L.DomUtil.create("div","mapbox-control-info mapbox-small"),this._content=L.DomUtil.create("div","map-info-container",this._container);var e=L.DomUtil.create("a","mapbox-info-toggle mapbox-icon mapbox-icon-info",this._container);e.href="#",L.DomEvent.addListener(e,"click",this._showInfo,this),L.DomEvent.disableClickPropagation(this._container);for(var n in t._layers)t._layers[n].getAttribution&&this.addInfo(t._layers[n].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd,this).off("layerremove",this._onLayerRemove,this)},addInfo:function(t){return t?(this._info[t]||(this._info[t]=0),this._info[t]=!0,this._update()):this},removeInfo:function(t){return t?(this._info[t]&&(this._info[t]=!1),this._update()):this},_showInfo:function(t){return L.DomEvent.preventDefault(t),this._active===!0?this._hidecontent():(L.DomUtil.addClass(this._container,"active"),this._active=!0,this._update(),void 0)},_hidecontent:function(){this._content.innerHTML="",this._active=!1,L.DomUtil.removeClass(this._container,"active")},_update:function(){if(!this._map)return this;this._content.innerHTML="";var t="none",e=[];for(var n in this._info)this._info.hasOwnProperty(n)&&this._info[n]&&(e.push(this.options.sanitizer(n)),t="block");return this._content.innerHTML+=e.join(" | "),this._container.style.display=t,this},_onLayerAdd:function(t){t.layer.getAttribution&&t.layer.getAttribution()?this.addInfo(t.layer.getAttribution()):"on"in t.layer&&t.layer.getAttribution&&t.layer.on("ready",L.bind(function(){this.addInfo(t.layer.getAttribution())},this))},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeInfo(t.layer.getAttribution())}});e.exports.InfoControl=n,e.exports.infoControl=function(t){return new n(t)}},{"sanitize-caja":5}],16:[function(t,e){"use strict";var n=L.Control.extend({options:{position:"bottomright",sanitizer:t("sanitize-caja")},initialize:function(t){L.setOptions(this,t),this._legends={}},onAdd:function(){return this._container=L.DomUtil.create("div","map-legends wax-legends"),L.DomEvent.disableClickPropagation(this._container),this._update(),this._container},addLegend:function(t){return t?(this._legends[t]||(this._legends[t]=0),this._legends[t]++,this._update()):this},removeLegend:function(t){return t?(this._legends[t]&&this._legends[t]--,this._update()):this},_update:function(){if(!this._map)return this;this._container.innerHTML="";var t="none";for(var e in this._legends)if(this._legends.hasOwnProperty(e)&&this._legends[e]){var n=L.DomUtil.create("div","map-legend wax-legend",this._container);n.innerHTML=this.options.sanitizer(e),t="block"}return this._container.style.display=t,this}});e.exports.LegendControl=n,e.exports.legendControl=function(t){return new n(t)}},{"sanitize-caja":5}],17:[function(t,e){"use strict";var n=t("./request"),o=t("./url"),i=t("./util");e.exports={_loadTileJSON:function(t){"string"==typeof t?(-1==t.indexOf("/")&&(t=o.base()+t+".json"),n(o.secureFlag(t),L.bind(function(e,n){e?(i.log("could not load TileJSON at "+t),this.fire("error",{error:e})):n&&(this._setTileJSON(n),this.fire("ready"))},this))):t&&"object"==typeof t&&this._setTileJSON(t)}}},{"./request":20,"./url":24,"./util":25}],18:[function(t,e){"use strict";var n=(t("./util"),t("./tile_layer").tileLayer),o=t("./feature_layer").featureLayer,i=t("./grid_layer").gridLayer,r=t("./grid_control").gridControl,a=t("./info_control").infoControl,s=t("./share_control").shareControl,l=t("./legend_control").legendControl,c=L.Map.extend({includes:[t("./load_tilejson")],options:{tileLayer:{},featureLayer:{},gridLayer:{},legendControl:{},gridControl:{},infoControl:!1,shareControl:!1},_tilejson:{},initialize:function(t,e,c){L.Map.prototype.initialize.call(this,t,c),this.attributionControl&&this.attributionControl.setPrefix(""),this.options.tileLayer&&(this.tileLayer=n(void 0,this.options.tileLayer),this.addLayer(this.tileLayer)),this.options.featureLayer===!1||this.options.markerLayer===!1?this.options.featureLayer=this.options.markerLayer=!1:this.options.markerLayer&&(this.options.featureLayer=this.options.markerLayer),this.options.featureLayer&&(this.featureLayer=this.markerLayer=o(void 0,this.options.featureLayer),this.addLayer(this.featureLayer)),this.options.gridLayer&&(this.gridLayer=i(void 0,this.options.gridLayer),this.addLayer(this.gridLayer)),this.options.gridLayer&&this.options.gridControl&&(this.gridControl=r(this.gridLayer,this.options.gridControl),this.addControl(this.gridControl)),this.options.infoControl&&(this.infoControl=a(this.options.infoControl),this.addControl(this.infoControl)),this.options.legendControl&&(this.legendControl=l(this.options.legendControl),this.addControl(this.legendControl)),this.options.shareControl&&(this.shareControl=s(void 0,this.options.shareControl),this.addControl(this.shareControl)),this._loadTileJSON(e)},addLayer:function(t){return"on"in t&&t.on("ready",L.bind(function(){this._updateLayer(t)},this)),L.Map.prototype.addLayer.call(this,t)},_setTileJSON:function(t){return this._tilejson=t,this._initialize(t),this},getTileJSON:function(){return this._tilejson},_initialize:function(t){if(this.tileLayer&&(this.tileLayer._setTileJSON(t),this._updateLayer(this.tileLayer)),this.featureLayer&&!this.featureLayer.getGeoJSON()&&t.data&&t.data[0]&&this.featureLayer.loadURL(t.data[0]),this.gridLayer&&(this.gridLayer._setTileJSON(t),this._updateLayer(this.gridLayer)),this.infoControl&&t.attribution&&this.infoControl.addInfo(t.attribution),this.legendControl&&t.legend&&this.legendControl.addLegend(t.legend),this.shareControl&&this.shareControl._setTileJSON(t),!this._loaded&&t.center){var e=t.center[2],n=L.latLng(t.center[1],t.center[0]);this.setView(n,e)}},_editLink:function(){if(this._controlContainer.getElementsByClassName){var t=this._controlContainer.getElementsByClassName("mapbox-improve-map");if(t.length&&this._loaded)for(var e=this.getCenter().wrap(),n=this._tilejson||{},o=n.id||"",i=0;i<t.length;i++)t[i].href=t[i].href.split("#")[0]+"#"+o+"/"+e.lng.toFixed(3)+"/"+e.lat.toFixed(3)+"/"+this.getZoom()}},_updateLayer:function(t){t.options&&(this.infoControl&&this._loaded&&this.infoControl.addInfo(t.options.infoControl),this.attributionControl&&this._loaded&&t.getAttribution&&this.attributionControl.addAttribution(t.getAttribution()),this.on("moveend",this._editLink,this),L.stamp(t)in this._zoomBoundLayers||!t.options.maxZoom&&!t.options.minZoom||(this._zoomBoundLayers[L.stamp(t)]=t),this._editLink(),this._updateZoomLevels())}});e.exports.Map=c,e.exports.map=function(t,e,n){return new c(t,e,n)}},{"./feature_layer":9,"./grid_control":13,"./grid_layer":14,"./info_control":15,"./legend_control":16,"./load_tilejson":17,"./share_control":21,"./tile_layer":23,"./util":25}],19:[function(t,e){"use strict";function n(t){t=t||{};var e={small:[20,50],medium:[30,70],large:[35,90]},n=t["marker-size"]||"medium",o=t["marker-symbol"]?"-"+t["marker-symbol"]:"",i=(t["marker-color"]||"7e7e7e").replace("#","");return L.icon({iconUrl:r.base()+"marker/pin-"+n.charAt(0)+o+"+"+i+(L.Browser.retina?"@2x":"")+".png",iconSize:e[n],iconAnchor:[e[n][0]/2,e[n][1]/2],popupAnchor:[0,-e[n][1]/2]})}function o(t,e){return L.marker(e,{icon:n(t.properties),title:a.strip_tags(s(t.properties&&t.properties.title||""))})}function i(t,e){if(!t||!t.properties)return"";var n="";return t.properties.title&&(n+='<div class="marker-title">'+t.properties.title+"</div>"),t.properties.description&&(n+='<div class="marker-description">'+t.properties.description+"</div>"),(e||s)(n)}var r=t("./url"),a=t("./util"),s=t("sanitize-caja");e.exports={icon:n,style:o,createPopup:i}},{"./url":24,"./util":25,"sanitize-caja":5}],20:[function(t,e){"use strict";var n=t("corslite"),o=t("json3"),i=t("./util").strict;e.exports=function(t,e){function r(t,n){!t&&n&&(n="g"==n.responseText[0]?o.parse(n.responseText.substring(5,n.responseText.length-2)):o.parse(n.responseText)),e(t,n)}return i(t,"string"),i(e,"function"),n(t,r)}},{"./util":25,corslite:2,json3:3}],21:[function(t,e){"use strict";var n=t("./url"),o=L.Control.extend({includes:[t("./load_tilejson")],options:{position:"topleft",url:""},initialize:function(t,e){L.setOptions(this,e),this._loadTileJSON(t)},_setTileJSON:function(t){this._tilejson=t},onAdd:function(t){this._map=t,this._url=n;var e=L.DomUtil.create("div","leaflet-control-mapbox-share leaflet-bar"),o=L.DomUtil.create("a","mapbox-share mapbox-icon mapbox-icon-share",e);return o.href="#",this._modal=L.DomUtil.create("div","mapbox-modal",this._map._container),this._mask=L.DomUtil.create("div","mapbox-modal-mask",this._modal),this._content=L.DomUtil.create("div","mapbox-modal-content",this._modal),L.DomEvent.addListener(o,"click",this._shareClick,this),L.DomEvent.disableClickPropagation(e),this._map.on("mousedown",this._clickOut,this),e},_clickOut:function(t){return this._sharing?(L.DomEvent.preventDefault(t),L.DomUtil.removeClass(this._modal,"active"),this._content.innerHTML="",this._sharing=null,void 0):void 0},_shareClick:function(t){if(L.DomEvent.stop(t),this._sharing)return this._clickOut(t);var e=this._tilejson||this._map._tilejson||{},n=encodeURIComponent(this.options.url||e.webpage||window.location),o=encodeURIComponent(e.name),i=this._url.base()+e.id+"/"+this._map.getCenter().lng+","+this._map.getCenter().lat+","+this._map.getZoom()+"/600x600.png",r=this._url.base()+e.id+".html?secure",a="//twitter.com/intent/tweet?status="+o+" "+n,s="//www.facebook.com/sharer.php?u="+n+"&t="+encodeURIComponent(e.name),l="//www.pinterest.com/pin/create/button/?url="+n+"&media="+i+"&description="+e.name,c="<h3>Share this map</h3><div class='mapbox-share-buttons'><a class='mapbox-button mapbox-button-icon mapbox-icon-facebook' target='_blank' href='{{facebook}}'>Facebook</a><a class='mapbox-button mapbox-button-icon mapbox-icon-twitter' target='_blank' href='{{twitter}}'>Twitter</a><a class='mapbox-button mapbox-button-icon mapbox-icon-pinterest' target='_blank' href='{{pinterest}}'>Pinterest</a></div>".replace("{{twitter}}",a).replace("{{facebook}}",s).replace("{{pinterest}}",l),u='<iframe width="100%" height="500px" frameBorder="0" src="{{embed}}"></iframe>'.replace("{{embed}}",r),h="Copy and paste this <strong>HTML code</strong> into documents to embed this map on web pages.";
L.DomUtil.addClass(this._modal,"active"),this._sharing=L.DomUtil.create("div","mapbox-modal-body",this._content),this._sharing.innerHTML=c;var p=L.DomUtil.create("input","mapbox-embed",this._sharing);p.type="text",p.value=u;var f=L.DomUtil.create("label","mapbox-embed-description",this._sharing);f.innerHTML=h;var d=L.DomUtil.create("a","leaflet-popup-close-button",this._sharing);d.href="#",L.DomEvent.disableClickPropagation(this._sharing),L.DomEvent.addListener(d,"click",this._clickOut,this),L.DomEvent.addListener(p,"click",function(t){t.target.focus(),t.target.select()})}});e.exports.ShareControl=o,e.exports.shareControl=function(t,e){return new o(t,e)}},{"./load_tilejson":17,"./url":24}],22:[function(t,e){"use strict";function n(t,e){var n={};for(var o in e)n[o]=void 0===t[o]?e[o]:t[o];return n}function o(t){for(var e={},n=0;n<a.length;n++)e[a[n][1]]=t[a[n][0]];return e}function i(t){return o(n(t.properties||{},r))}var r={stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":.5},a=[["stroke","color"],["stroke-width","weight"],["stroke-opacity","opacity"],["fill","fillColor"],["fill-opacity","fillOpacity"]];e.exports={style:i,defaults:r}},{}],23:[function(t,e){"use strict";var n=t("./util"),o=(t("./url"),L.TileLayer.extend({includes:[t("./load_tilejson")],options:{format:"png"},formats:["png","png32","png64","png128","png256","jpg70","jpg80","jpg90"],scalePrefix:"@2x.",initialize:function(t,e){L.TileLayer.prototype.initialize.call(this,void 0,e),this._tilejson={},e&&e.detectRetina&&L.Browser.retina&&e.retinaVersion&&(t=e.retinaVersion),e&&e.format&&n.strict_oneof(e.format,this.formats),this._loadTileJSON(t)},setFormat:function(t){return n.strict(t,"string"),this.options.format=t,this.redraw(),this},_autoScale:function(){return this.options&&L.Browser.retina&&this.options.detectRetina&&!this.options.retinaVersion&&this.options.autoscale},setUrl:null,_setTileJSON:function(t){return n.strict(t,"object"),L.extend(this.options,{tiles:t.tiles,attribution:t.attribution,minZoom:t.minzoom||0,maxZoom:t.maxzoom||18,autoscale:t.autoscale||!1,tms:"tms"===t.scheme,bounds:t.bounds&&n.lbounds(t.bounds)}),this._tilejson=t,this.redraw(),this},getTileJSON:function(){return this._tilejson},getTileUrl:function(t){var e=this.options.tiles,n=Math.floor(Math.abs(t.x+t.y)%e.length),o=e[n],i=L.Util.template(o,t);return i?i.replace(".png",(this._autoScale()?this.scalePrefix:".")+this.options.format):i},_update:function(){this.options.tiles&&L.TileLayer.prototype._update.call(this)}}));e.exports.TileLayer=o,e.exports.tileLayer=function(t,e){return new o(t,e)}},{"./load_tilejson":17,"./url":24,"./util":25}],24:[function(t,e){"use strict";var n=t("./config");e.exports={isSSL:function(){return"https:"===document.location.protocol||n.FORCE_HTTPS},base:function(){return(this.isSSL()?n.HTTPS_URLS:n.HTTP_URLS)[0]},secureFlag:function(t){return this.isSSL()?t.match(/(\?|&)secure/)?t:-1!==t.indexOf("?")?t+"&secure":t+"?secure":t},jsonify:function(t){return t.replace(/\.(geo)?jsonp(?=$|\?)/,".$1json")}}},{"./config":8}],25:[function(t,e){"use strict";function n(t,e){if(!e||!e.length)return!1;for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}e.exports={idUrl:function(t,e){-1==t.indexOf("/")?e.loadID(t):e.loadURL(t)},log:function(t){console&&"function"==typeof console.error&&console.error(t)},strict:function(t,e){if(typeof t!==e)throw new Error("Invalid argument: "+e+" expected")},strict_instance:function(t,e,n){if(!(t instanceof e))throw new Error("Invalid argument: "+n+" expected")},strict_oneof:function(t,e){if(!n(t,e))throw new Error("Invalid argument: "+t+" given, valid values are "+e.join(", "))},strip_tags:function(t){return t.replace(/<[^<]+>/g,"")},lbounds:function(t){return new L.LatLngBounds([[t[1],t[0]],[t[3],t[2]]])}}},{}]},{},[1]);